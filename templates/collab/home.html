{% extends "base.html" %}
{% load static %}   <!-- âœ… static íƒœê·¸ ë¡œë”© ì¶”ê°€ -->

{% block title %}ë°© ëª©ë¡ Â· CodingLine{% endblock %}

{% block content %}
<!-- ëª¨ë°”ì¼ ê²€ìƒ‰ -->
<form action="{% url 'home' %}" method="get" class="search search--mobile">
  <input name="q" value="{{ q }}" placeholder="ë°© ê²€ìƒ‰" class="search__input" />
</form>

<!-- ë¯¸ë‹ˆë©€ í—¤ë” -->
<header class="head">
  <div class="head__title">codingline</div>
  <p class="head__desc">ìŒì•… ëŒ€ì‹  <b>ë°© ì •ë³´</b>ë¥¼ ê³µìœ í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤.</p>
</header>

<div class="grid">
  <!-- ì¢Œ: ë°© ìƒì„± -->
  <section class="col col--left">
    <div class="card">
      <h2 class="card__title">ìƒˆ ë°© ë§Œë“¤ê¸°</h2>
      <form action="{% url 'home' %}" method="post" class="form">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <label class="field">
          <span class="field__label">ë°© ì œëª©</span>
          {{ form.Romname }}
          {{ form.Romname.errors }}
        </label>

        <label class="field">
          <span class="field__label">ì£¼ì œ</span>
          {{ form.topic }}
          {{ form.topic.errors }}
        </label>

        <label class="field">
          <span class="field__label">ì•”í˜¸</span>
          {{ form.password }}
          {{ form.password.errors }}
        </label>

        <label class="check">
          {{ form.is_private }} <span>ë¹„ê³µê°œ</span>
        </label>

        <label class="field">
          <span class="field__label">ì •ì›</span>
          {{ form.capacity }}
          {{ form.capacity.errors }}
        </label>

        <button class="btn btn--brand">ë§Œë“¤ê¸°</button>
      </form>
    </div>
  </section>

  <!-- ìš°: ë°© ëª©ë¡ -->
  <section class="col col--right">
    <div class="list__head">
      <h2 class="card__title">ë°© ëª©ë¡</h2>
      {% if q %}<span class="muted">â€œ{{ q }}â€ ê²€ìƒ‰ ê²°ê³¼</span>{% endif %}
    </div>

    <!-- âœ… id="room-list" ì¶”ê°€ -->
    <ul id="room-list" class="list">
      {% for r in rooms %}
        {% if not r.is_private or q %}
        <!-- âœ… ê° ë°© liì— id ë¶€ì—¬ -->
        <li id="room-{{ r.id }}" class="item" data-room-slug="{{ r.slug }}">
          <div class="item__left">
            <div class="item__thumb">ğŸ </div>
            <div>
              <div class="item__title font-medium">{{ r.Romname }}</div>
              <div class="item__meta">
                ì£¼ì œ: {{ r.topic }} Â· ìƒì„±: {{ r.created_at|date:"Y-m-d H:i" }}
                Â· ë°©ì¥: {{ r.created_by.display_name|default:r.created_by.username }}
                {% if r.password %} Â· ğŸ”’{% endif %}
                {% if r.is_private %} Â· (ë¹„ê³µê°œ){% endif %}
              </div>
            </div>
          </div>
          <a href="{% url 'room-detail' r.slug %}"
             class="link enter-btn"
             data-slug="{{ r.slug }}"
             {% if r.password %}data-locked="1"{% endif %}>ì…ì¥</a>
        </li>
        {% endif %}
      {% empty %}
        <li class="muted">í‘œì‹œí•  ë°©ì´ ì—†ìŠµë‹ˆë‹¤.</li>
      {% endfor %}
    </ul>

    <!-- ë¹„ë°€ë²ˆí˜¸ ë°°ë„ˆ -->
    <div id="pwBanner" class="pw">
      <div class="pw__box">
        <div class="pw__row">
          <strong id="pwBannerTitle">ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</strong>
          <input id="pwBannerInput" type="password" class="pw__input" placeholder="ë°© ë¹„ë°€ë²ˆí˜¸" />
          <button id="pwBannerSubmit" class="btn btn--brand">ì…ì¥</button>
          <button id="pwBannerClose"  class="btn">ë‹«ê¸°</button>
        </div>
        <p id="pwBannerErr" class="pw__err hidden"></p>
      </div>
    </div>
  </section>
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script src="{% static 'js/home.js' %}"></script>
{% endblock %}
